import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import Caret from '@site/static/img/caret.svg'

### PLD Resource Properties

<div class="container">
  <div class="child3">

<details className="objectPropertiesDetails" style={{ maxWidth: "100%", padding: "1rem" }}>
<summary style={{fontSize: "16px"}}>Resource Properties</summary>

<table className="objectProperties">
<tr>
<td>`pldId` <br /><span class="type-text">integer</span></td>
<td>PLD ID</td>
</tr>
<tr>
  <td>`pldName` <br /><span class="type-text">string</span></td>
  <td>PLD name</td>
</tr>
<tr>
  <td>`campaignId` <br /><span class="type-text">integer</span></td>
  <td>[Campaign ID](/Guidelines/Campaign-API-Guidelines#get-list-of-campaigns)</td>
</tr>
<tr>
  <td>`campaignName` <br /><span class="type-text">string</span></td>
  <td>Campaign name</td>
</tr>
<tr>
  <td>`pldStatusId` <br /><span class="type-text">integer</span></td>
  <td>[PLD Status Type ID](/Guidelines/Insights-API-Guidelines#get-list-of-insights-status)</td>
</tr>
<tr>
  <td>`startDate` <br /><span class="type-text">integer</span></td>
  <td>Unix epoch timestamp of start date, in milliseconds</td>
</tr>
<tr>
  <td>`endDate` <br /><span class="type-text">integer</span></td>
  <td>Unix epoch timestamp of end date, in milliseconds</td>
</tr>
<tr>
  <td>`ioId` <br /><span class="type-text">integer</span></td>
  <td>[Insertion Order ID](/Guidelines/Campaign-API-Guidelines#get-insertion-order-details)</td>
</tr>
<tr>
  <td>`ioName` <br /><span class="type-text">string</span></td>
  <td>Insertion Order name</td>
</tr>
<tr>
  <td>`ioTypeId` <br /><span class="type-text">integer</span></td>
  <td>[Insertion Order Budget Type ID](/Guidelines/Campaign-API-Guidelines#get-list-of-campaign-budget-types)</td>
</tr>
<tr>
  <td>`isCampaignEligible` <br /><span class="type-text">boolean</span></td>
  <td>Indicates that Campaign is eligible for VLD Report: <var>true</var></td>
</tr>
<tr>
  <td>`pldCreatedOn` <br /><span class="type-text">integer</span></td>
  <td>Unix epoch timestamp of creation date, in milliseconds</td>
</tr>
<tr>
  <td>`creativeTypeId` <br /><span class="type-text">integer</span></td>
  <td>[Creative Type ID](/Guidelines/Creative-API-Guidelines#get-creative-types-list)</td>
</tr>
<tr>
  <td>`campaignPldTimezoneId` <br /><span class="type-text">integer</span></td>
  <td>[Timezone ID](/Guidelines/Master-API-Guidelines#get-timezones)</td>
</tr>
<tr>
  <td>`pldReportCreatable` <br /><span class="type-text">boolean</span></td>
  <td>Indicates if PLD Report can be generated for the given Campaign and date range (<var>true</var>)</td>
</tr>
<tr>
  <td> `pldChargeableImps` <br /><span class="type-text">integer</span></td>
  <td>The number of chargeable impressions for the requested PLD Report</td>
</tr>
<tr>
  <td>`pldChargedImps` <br /><span class="type-text">integer</span></td>
  <td>The number of impressions for which the PLD Report is already generated</td>
</tr>
<tr>
  <td>`pldChargeableCost` <br /><span class="type-text">integer</span></td>
  <td>Cost to generate the PLD Report</td>
</tr>
<tr>
  <td>`pldChargedCost` <br /><span class="type-text">integer</span></td>
  <td>Cost of PLD Report that is already generated</td>
</tr>
<tr>
  <td>`fundsAvailable` <br /><span class="type-text">boolean</span></td>
  <td>Indicates if sufficient funds are available in the Advertiser's account to generate the PLD Report (<var>true</var>)</td>
</tr>
</table>

</details>

</div></div>

---

### Get List of PLD Reports

<span class="badge badge--primary">GET</span> <span class="path-text">/api/v3/ins/pld-reports</span>

<div class="container">
  <div class="child1">

Get a list of PLD Reports. 

A <var>pldId</var> can be used in the [Generate PLD Report](#generate-pld-report), [Download PLD Insight Report](#download-pld-report), and [Delete PLD Report](#delete-pld-report) endpoints. 

| Query Parameters |  |
| ---- | --- |
| `searchField` <br /><span class="type-text">string</span> | Search results by keyword |
| `noOfEntries` <br /><span class="type-text">integer</span> | Maximum number of entries per page, default: <var>200</var> |
| `pageNo` <br /><span class="type-text">integer</span> | Number of pages for retrieved data, default: <var>1</var> |
| `sortBy` <br /><span class="type-text">string</span> | Sorts by ascending (<var>+</var>) or descending (<var>-</var>), default: <var>-pldId</var> |

<a href="#pld-resource-properties"><button className="responsePropertiesButton"><Caret />Resource Properties</button></a>

</div>
<div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Response 200"
{
  "success": true,
  "data": {
    "totalRecords": 10,
    "pldReportDataList": [
      {
        "pldId": 10,
        "pldName": "530667_PLD_Insights_7",
        "campaignName": "prod-campaign-21145",
        "campaignId": 21145,
        "pldStatusId": 3,
        "startDate": 1732165200000,
        "endDate": 1732424399000,
        "ioId": 5,
        "ioName": "Corporate, Inc.",
        "isCampaignEligible": false,
        "pldCreatedOn": 1721253632,
        "creativeTypeId": 11,
        "campaignPldTimezoneId": 29,
        "ioTypeId": 1
      },
      {
        "pldId": 9,
        "pldName": "530667_PLD_Insights_6",
        "campaignName": "Campaign-4949",
        "campaignId": 4949,
        "pldStatusId": 3,
        "startDate": 1732165200000,
        "endDate": 1732424399000,
        "ioId": 15,
        "ioName": "Quinton for Mayor",
        "isCampaignEligible": false,
        "pldCreatedOn": 1720325578,
        "creativeTypeId": 14,
        "campaignPldTimezoneId": 29,
        "ioTypeId": 1
      }
    ],
    "filteredRecords": 10
  }
}
```

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/Getting%20Started/Typescript-Prerequisites.mdx) for usage. 

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    headers: {
      [name: string]: unknown;
    };
    content: {
      "application/json": {
        success: boolean;
        data: {
          totalRecords: number;
          filteredRecords: number;
          pldReportDataList: {
            pldId: number;
            pldName: string;
            campaignName: string;
            campaignId: number;
            pldStatusId: number;
            startDate: number;
            endDate: number;
            ioId: number;
            ioName: string;
            isCampaignEligible: boolean;
            pldCreatedOn: number;
            creativeTypeId: number;
            campaignPldTimezoneId: number;
            ioTypeId: number;
          }[];
        }
      }
    }
  };
}

function getPLDReportList(): Promise<Responses> {
  const options = {
    method: 'GET',
    url: 'https://api.iqm.com/api/v3/ins/pld-reports',
    params: {
      query?: {
        searchField?: `string`,
        pageNo?: `number`,
        noOfEntries?: `number`,
        sortBy?: `string`,
      }
    }
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>

---

### Get List of Campaigns Eligible for PLD Reports

<span class="badge badge--primary">GET</span> <span class="path-text">/api/v3/ins/pld-reports/campaigns</span>

<div class="container">
  <div class="child1">

Get a list of Campaign IDs by status eligible for PLD Report generation.

  <details className="objectPropertiesDetails" style={{ maxWidth: "100%", padding: "1rem" }}>
    <summary style={{fontSize: "16px"}}>Response Properties</summary>
    <table className="objectProperties">
    <tr>
    <td>`running`, `paused`, `expired` <br /><span class="type-text">array of objects</span></td>
    <td>Object array of Campaign IDs mapped to each of these three Campaign statuses</td>
    </tr>
    <tr>
  <td colSpan="2">
    <details className="objectPropertiesDetails">
    <summary>object properties</summary>
    <table className="objectProperties">
    <tr>
    <td>`campaignId` <br /><span class="type-text">integer</span></td>
    <td>Campaign ID</td>
    </tr>
      <tr>
    <td>`campaignTimezoneId` <br /><span class="type-text">integer</span></td>
    <td>Campaign timezone ID</td>
    </tr>
    </table></details>
    </td>
    <td></td>
  </tr>
    </table>
    </details>

</div><div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Response 200"
{
  "success": true,
  "data": {
    "running": [
      {
        "campaignId": 451351,
        "campaignTimezoneId": 29
      }
    ],
    "paused": [
      {
        "campaignId": 451350,
        "campaignTimezoneId": 29
      }
    ],
    "expired": [
      {
        "campaignId": 470839,
        "campaignTimezoneId": 29
      }
    ]
  }
}
```

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/Getting%20Started/Typescript-Prerequisites.mdx) for usage.

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    headers: {
      [name: string]: unknown;
    };
    content: {
      "application/json": {
        success: boolean;
        data: {
          running: number[];
          paused: number[];
          expired: number[];
        }
      }
    }
  };
}

function getStatusWiseCampaignsForPLDReports(): Promise<Responses> {
  const options = {
    method: 'GET',
    url: 'https://api.iqm.com/api/v3/ins/pld-reports/campaigns',
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>

---

### Generate PLD Report

<span class="badge badge--success">POST</span> <span class="path-text">/api/v3/ins/pld-report</span>

<div class="container">
  <div class="child1">

This API calculates the cost for the impressions for the Provider Level Data Reports based on the impressions and mark up charged on the Organization and then creates the PLD Reports.

:::info 

A Campaign must meet the following eligibility criteria to generate PLD Report: 
  * Must be healthcare Campaign 
  * "running", "expired" (within last 90 days), "paused" (within last 90 days) status
  * Must have duration of 3 or more days
  * Audience type: **Matched Audience** from NPI IDs

:::

| Request Schema |  |
| ---- | --- |
| `pldStartDate` <br /><span class="type-text">integer</span> | Unix epoch timestamp of start date, in milliseconds |
| `pldEndDate` <br /><span class="type-text">integer</span> | Unix epoch timestamp of end date, in milliseconds |
| `campaignId` <br /><span class="type-text">integer</span> | [Campaign ID](/Guidelines/Campaign-API-Guidelines#get-list-of-campaigns) |
| `pldId` <br /><span class="type-text">integer</span> | [PLD ID](#get-list-of-pld-reports) to regenerate |

<a href="#pld-resource-properties"><button className="responsePropertiesButton"><Caret />Resource Properties</button></a>

</div><div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Request Sample"
{
  "campaignId": 12345,
  "pldStartDate": 1722311000,
  "pldEndDate": 1722315000
}
```

```json title="Response 200"
{
  "success": true,
  "data": {
    "pldReportCreated": true,
    "campaignId": 1,
    "campaignName": "Campaign Name",
    "campaignStatus": "running",
    "pldStartDate": 1722311000,
    "pldEndDate": 1722315000,
    "pldChargeableImps": 1000,
    "pldChargedImps": 100,
    "pldChargeableCost": 1000,
    "pldChargedCost": 100,
    "fundsAvailable": true
  }
}
```

```json title="Response 200 (failure)"
{
  "success": true,
  "data": {
    "pldReportCreated": false,
    "message": "PLD Insights can't be generated for this campaign at the moment as another insight with overlapping date range is processing"
  }
}
```

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/Getting%20Started/Typescript-Prerequisites.mdx) for usage.

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    content: {
      "application/json": {
        success: boolean;
        data: {
          pldReportCreated: boolean;
          campaignId: number;
          campaignName: string;
          campaignStatus: string;
          pldStartDate: number;
          pldEndDate: number;
          pldChargeableImps: number;
          pldChargedImps: number;
          pldChargeableCost: number;
          pldChargedCost: number;
          fundsAvailable: boolean
        }
      }
    };
  };
}

function generatePLDReports(): Promise<Responses> {
  const options = {
    method: 'POST',
    url: 'https://api.iqm.com/api/v3/ins/pld-report',
    requestBody: {
      content: {
        "application/json": {
          campaignId?: `number`,
          pldId?: `number`,
          pldStartDate?: `number`,
          pldEndDate?: `number`,
          endDate?: `number`,
          startDate?: `number`,
          id?: `number`,
        }
      }
    }
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>

---

### Get PLD Reports Columns

<span class="badge badge--primary">GET</span> <span class="path-text">/api/v3/ins/pld-reports/columns</span>

<div class="container">
  <div class="child1">

Get columns details for PLD Reports. 

The response properties for this endpoint include names of each possible column paired with a boolean value indicating whether it is included in the report (<var>true</var>) or not (<var>false</var>).

</div>
<div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Response 200"
{
  "success": true,
  "data": {
    "id": true,
    "insightsName": true,
    "campaignName": true,
    "campaignId": true,
    "status": true,
    "dateRange": true,
    "createdOn": true,
    "ioName": true,
    "ioId": false
  }
}
```

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/Getting%20Started/Typescript-Prerequisites.mdx) for usage. 

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    content: {
      "application/json": {
        success: boolean;
        data: {
          id: boolean;
          insightsName: boolean;
          campaignName: boolean;
          campaignId: boolean;
          status: boolean;
          dateRange: boolean;
          createdOn: boolean;
          ioName: boolean;
          ioId: boolean;
        }
      }
    };
  };
}

function fetchPLDReportSelectedColumns(): Promise<Responses> {
  const options = {
    method: 'GET',
    url: 'https://api.iqm.com/api/v3/ins/pld-reports/columns',
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>

---

### Update PLD Reports Columns

<span class="badge badge--success">POST</span> <span class="path-text">/api/v3/ins/pld-reports/columns</span>

<div class="container">
  <div class="child1">

Save or update the selection of columns shown in PLD Reports. 

The request schema and response properties for this endpoint include names of each possible column paired with a boolean value indicating whether it is included in the report (<var>true</var>) or not (<var>false</var>).

</div>
<div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Request Sample"
{
  "id": true,
  "insightsName": true,
  "campaignName": true,
  "campaignId": true,
  "status": true,
  "dateRange": true,
  "createdOn": true,
  "ioName": true,
  "ioId": false
}
```

```json title="Response 200"
{
  "success": true,
  "data": {
    "id": true,
    "insightsName": true,
    "campaignName": true,
    "campaignId": true,
    "status": true,
    "dateRange": true,
    "createdOn": true,
    "ioName": true,
    "ioId": false
  }
}
```

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/Getting%20Started/Typescript-Prerequisites.mdx) for usage. 

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    content: {
      "application/json": {
        success: boolean;
        data: {
          id: boolean;
          insightsName: boolean;
          campaignName: boolean;
          campaignId: boolean;
          status: boolean;
          dateRange: boolean;
          createdOn: boolean;
          ioName: boolean;
          ioId: boolean;
        }
      }
    };
  };
}

function saveOrUpdatePLDReportSelectedColumns(): Promise<Responses> {
  const options = {
    method: 'POST',
    url: 'https://api.iqm.com/api/v3/ins/pld-reports/columns',
    requestBody: {
      content: {
        "application/json": {
            id: `boolean`,
            insightsName: `boolean`,
            campaignName: `boolean`,
            campaignId: `boolean`,
            status: `boolean`,
            dateRange: `boolean`,
            createdOn: `boolean`,
            ioName: `boolean`,
            ioId: `boolean`,
        }
      }
    }
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>

---

### Download PLD Report

<span class="badge badge--success">POST</span> <span class="path-text">/api/v3/ins/pld-report/download</span>

<div class="container">
  <div class="child1">

Get a download link for a PLD insight Report in CSV or XLSX format.

| Request Schema | |
| --- | --- |
| `fileType` <br /><span class="type-text">integer</span> | File type ID <br />XLSX: <var>1</var> <br />CSV: <var>2</var>
| `pldId` <br /><span class="type-text">integer</span> | [Provider Level Data Report ID](#get-list-of-pld-reports)

<details className="objectPropertiesDetails" style={{ maxWidth: "800px", padding: "1rem" }}>
  <summary style={{ fontSize: "16px" }}>Response Properties</summary>

<table className="objectProperties">
<tr>
  <td>`pldReportUrl` <br /><span class="type-text">string</span></td>
  <td>PLD Report File URL</td>
</tr>
</table>
</details>

</div>
<div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Request Sample"
{
  "fileType": 1,
  "pldId": 50
}
```

```json title="Response 200"
{
  "success": true,
  "data": {
    "pldReportUrl": "https://dowload.domain.com/pld-reports/20220101/pld-report-1.xlsx"
  }
}
```

<details className="objectPropertiesDetails" style={{ maxWidth: "100%", padding: "1rem" }}>
<summary style={{fontSize: "16px"}}>More Responses</summary>

```json title="Response 422"
{
  "success": false,
  "errorObjects": [
    {
      "error": "Invalid sortBy value."
    }
  ]
}
```

</details>



</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/Getting%20Started/Typescript-Prerequisites.mdx) for usage. 

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    content: {
      "application/json": {
        success: boolean;
        data: {
          pldReportUrl: string;
        }
      }
    };
  };
}

function getPLDReportDownloadUrl(): Promise<Responses> {
  const options = {
    method: 'POST',
    url: 'https://api.iqm.com/api/v3/ins/pld-report/download',
    requestBody: {
      content: {
        "application/json": {
          fileTypeId?: `number`,
          vldId?: `number`,
          pldId?: `number`,
        }
      }
    }
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>

---

### Delete PLD Report

<span class="badge badge--danger">DELETE</span> <span class="path-text">/api/v3/ins/pld-reports</span>

<div class="container">
  <div class="child1">

Deletes PLD Reports that are not marked as deleted and have a 'failed' status, requires user authorization and checks if the provided PLD IDs are valid.

| Query Parameters |  |
| ---- | --- |
| `pldIds` <br /><span class="type-text">string</span> | Comma separated [PLD ID](#get-list-of-pld-reports)s |

  <details className="objectPropertiesDetails" style={{ maxWidth: "100%", padding: "1rem" }}>
    <summary style={{fontSize: "16px"}}>Response Properties</summary>
    <table className="objectProperties">
    <tr>
    <td>`success` <br /><span class="type-text">boolean</span></td>
    <td>Indicates Report was succesfully deleted: <var>true</var></td>
    </tr>
    <tr>
    <td>`message` <br /><span class="type-text">string</span></td>
    <td>Success message</td>
    </tr>
    </table>
    </details>

</div>
<div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Response 200"
{
  "success": true,
  "data": {
    "message": "255944_PLD_Insights_2 deleted successfully"
  }
}
```

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/Getting%20Started/Typescript-Prerequisites.mdx) for usage. 

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    content: {
      "application/json": {
        success: boolean;
        data: {
          message: string;
        }
      }
    };
  };
}

function deleteFailedPLDReport(): Promise<Responses> {
  const options = {
    method: 'DELETE',
    url: 'https://api.iqm.com/api/v3/ins/pld-reports',
    params: {
      query: {
        pldIds: `string`,
      }
    }
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>